{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["file:///E:/university/frontend/app/api/vendor/course/route.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport axios from \"axios\";\r\nimport { cookies } from \"next/headers\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\n\r\n\r\nexport async function GET() {\r\n  try {\r\n    const cookieStore = await cookies();\r\n    const vendor_token = cookieStore.get(\"vendor_token\")?.value;\r\n\r\n    const response = await axios.get(\r\n      `${process.env.NEXT_PUBLIC_BACKEND_URL}/vendor/courses`,\r\n      {\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${vendor_token}`,\r\n        },\r\n      }\r\n    );\r\n\r\n    return NextResponse.json({\r\n      message: \"Courses fetched successfully\",\r\n      data: response.data,\r\n    });\r\n  } catch (error: unknown) {\r\n    console.error(\"Error fetching courses:\", error);\r\n\r\n    // Axios errors have a 'response' object with status and data\r\n    if (axios.isAxiosError(error)) {\r\n      const status = error.response?.status || 500;\r\n      const errorMessage =\r\n        error.response?.data?.message || \"An unknown server error occurred.\";\r\n\r\n      return NextResponse.json(\r\n        {\r\n          message: errorMessage,\r\n          details: error.response?.data || null,\r\n        },\r\n        { status }\r\n      );\r\n    }\r\n\r\n    // Fallback for unexpected errors\r\n    return NextResponse.json(\r\n      { message: \"Failed to fetch courses due to an unexpected error.\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const formData = await request.formData();\r\n\r\n    const payload = JSON.parse(formData.get(\"payload\") as string);\r\n    const thumbnail = formData.get(\"thumbnail\") as File | null;\r\n\r\n    const lessonsWithVideos = payload.lessons.map((lesson: any, index: number) => ({\r\n      ...lesson,\r\n      videoFile: formData.get(`lessonVideo_${index}`) as File | null,\r\n    }));\r\n\r\n    const cookieStore = await cookies();\r\n    const vendorToken = cookieStore.get(\"vendor_token\")?.value;\r\n\r\n    if (!vendorToken) {\r\n      return NextResponse.json({ message: \"Unauthorized\" }, { status: 401 });\r\n    }\r\n\r\n    // Construct FormData for Axios\r\n    const formToSend = new FormData();\r\n    formToSend.append(\"payload\", JSON.stringify(payload));\r\n    if (thumbnail) formToSend.append(\"thumbnail\", thumbnail);\r\n    lessonsWithVideos.forEach((lesson: { videoFile: string | Blob; }, index: any) => {\r\n      if (lesson.videoFile) formToSend.append(`lessonVideo_${index}`, lesson.videoFile);\r\n    });\r\n\r\n    const url = `${process.env.NEXT_PUBLIC_BACKEND_URL}/vendor/create/course`;\r\n    const response = await axios.post(url, formToSend, {\r\n      headers: {\r\n        Authorization: `Bearer ${vendorToken}`,\r\n      },\r\n    });\r\n\r\n    console.log(response)\r\n\r\n    return NextResponse.json({\r\n      message: \"Course created successfully\",\r\n      data: response.data,\r\n    });\r\n  } catch (error) {\r\n    console.log(error.response.data)\r\n    console.error(\"Error processing form:\", error);\r\n    return NextResponse.json({\r\n      success: false,\r\n      error: (error as Error).message,\r\n    });\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,qDAAqD;;;;;;AACrD;AACA;AACA;;;;AAGO,eAAe;IACpB,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,4IAAO;QACjC,MAAM,eAAe,YAAY,GAAG,CAAC,iBAAiB;QAEtD,MAAM,WAAW,MAAM,kJAAK,CAAC,GAAG,CAC9B,iEAAuC,eAAe,CAAC,EACvD;YACE,SAAS;gBACP,gBAAgB;gBAChB,eAAe,CAAC,OAAO,EAAE,cAAc;YACzC;QACF;QAGF,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM,SAAS,IAAI;QACrB;IACF,EAAE,OAAO,OAAgB;QACvB,QAAQ,KAAK,CAAC,2BAA2B;QAEzC,6DAA6D;QAC7D,IAAI,kJAAK,CAAC,YAAY,CAAC,QAAQ;YAC7B,MAAM,SAAS,MAAM,QAAQ,EAAE,UAAU;YACzC,MAAM,eACJ,MAAM,QAAQ,EAAE,MAAM,WAAW;YAEnC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBACE,SAAS;gBACT,SAAS,MAAM,QAAQ,EAAE,QAAQ;YACnC,GACA;gBAAE;YAAO;QAEb;QAEA,iCAAiC;QACjC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;QAAsD,GACjE;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,WAAW,MAAM,QAAQ,QAAQ;QAEvC,MAAM,UAAU,KAAK,KAAK,CAAC,SAAS,GAAG,CAAC;QACxC,MAAM,YAAY,SAAS,GAAG,CAAC;QAE/B,MAAM,oBAAoB,QAAQ,OAAO,CAAC,GAAG,CAAC,CAAC,QAAa,QAAkB,CAAC;gBAC7E,GAAG,MAAM;gBACT,WAAW,SAAS,GAAG,CAAC,CAAC,YAAY,EAAE,OAAO;YAChD,CAAC;QAED,MAAM,cAAc,MAAM,IAAA,4IAAO;QACjC,MAAM,cAAc,YAAY,GAAG,CAAC,iBAAiB;QAErD,IAAI,CAAC,aAAa;YAChB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACtE;QAEA,+BAA+B;QAC/B,MAAM,aAAa,IAAI;QACvB,WAAW,MAAM,CAAC,WAAW,KAAK,SAAS,CAAC;QAC5C,IAAI,WAAW,WAAW,MAAM,CAAC,aAAa;QAC9C,kBAAkB,OAAO,CAAC,CAAC,QAAuC;YAChE,IAAI,OAAO,SAAS,EAAE,WAAW,MAAM,CAAC,CAAC,YAAY,EAAE,OAAO,EAAE,OAAO,SAAS;QAClF;QAEA,MAAM,MAAM,iEAAuC,qBAAqB,CAAC;QACzE,MAAM,WAAW,MAAM,kJAAK,CAAC,IAAI,CAAC,KAAK,YAAY;YACjD,SAAS;gBACP,eAAe,CAAC,OAAO,EAAE,aAAa;YACxC;QACF;QAEA,QAAQ,GAAG,CAAC;QAEZ,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM,SAAS,IAAI;QACrB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC,MAAM,QAAQ,CAAC,IAAI;QAC/B,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO,AAAC,MAAgB,OAAO;QACjC;IACF;AACF","debugId":null}}]
}